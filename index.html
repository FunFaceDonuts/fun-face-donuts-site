<!-- Chatbot Fun Face Donuts -->
<style>
  #chatToggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #ff9800;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    z-index: 9999;
  }
  #chatWidget {
    position: fixed;
    bottom: 90px;
    right: 20px;
    width: 320px;
    height: 470px;
    border-radius: 10px;
    border: 1px solid #ccc;
    background: #fff;
    display: none;
    flex-direction: column;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 9998;
  }
  #chatHeader {
    background: #ff9800;
    color: white;
    padding: 12px;
    font-weight: bold;
    border-radius: 10px 10px 0 0;
  }
  #chatbox {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
    background: #fafafa;
  }
  .msg {
    margin: 5px 0;
    padding: 8px 12px;
    border-radius: 15px;
    max-width: 80%;
    word-wrap: break-word;
  }
  .user { background: #d1e7ff; margin-left: auto; text-align: right; }
  .bot { background: #f1f1f1; margin-right: auto; text-align: left; }
  #quickReplies {
    display: flex;
    justify-content: center;
    gap: 5px;
    padding: 6px;
    border-top: 1px solid #eee;
    background: #fafafa;
  }
  .quick-btn {
    background: #eee;
    border: 1px solid #ccc;
    border-radius: 15px;
    padding: 5px 10px;
    cursor: pointer;
    font-size: 13px;
  }
  .quick-btn:hover { background: #ff9800; color: #fff; }
  #inputArea {
    display: flex;
    padding: 8px;
    border-top: 1px solid #ddd;
  }
  #input {
    flex: 1;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  #send {
    padding: 8px 12px;
    margin-left: 5px;
    background: #ff9800;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  @media (max-width: 420px) {
    #chatWidget { right: 10px; width: 90%; }
    #chatToggle { right: 10px; bottom: 14px; }
  }
</style>

<!-- Floating button -->
<button id="chatToggle">ðŸ’¬</button>

<!-- Widget chat -->
<div id="chatWidget">
  <div id="chatHeader">Fun Face Donuts</div>
  <div id="chatbox"></div>
  <div id="quickReplies">
    <button class="quick-btn">Harga</button>
    <button class="quick-btn">Lokasi</button>
    <button class="quick-btn">Jam Buka</button>
  </div>
  <div id="inputArea">
    <input id="input" placeholder="Tulis pesan..." />
    <button id="send">Kirim</button>
  </div>
</div>

<script>
  const WEBHOOK_URL = "https://miidaaa.app.n8n.cloud/webhook/funface-chatbot";

  const toggleBtn = document.getElementById("chatToggle");
  const widget = document.getElementById("chatWidget");
  const chatbox = document.getElementById("chatbox");
  const input = document.getElementById("input");
  const sendBtn = document.getElementById("send");
  const quickBtns = document.querySelectorAll(".quick-btn");

  let greeted = localStorage.getItem("chatbot_greeted");

  function addMessage(text, sender) {
    const div = document.createElement("div");
    div.className = `msg ${sender}`;
    div.textContent = text;
    chatbox.appendChild(div);
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  function showGreeting() {
    if (!greeted) {
      addMessage("Halo ðŸ‘‹, selamat datang di Fun Face Donuts! Silakan pilih tombol cepat atau ketik pertanyaanmu.", "bot");
      localStorage.setItem("chatbot_greeted", "true");
    }
  }

  toggleBtn.addEventListener("click", () => {
    widget.style.display = widget.style.display === "flex" ? "none" : "flex";
    if (widget.style.display === "flex") showGreeting();
  });

  async function sendMessage(msg) {
    if (!msg) return;
    addMessage(msg, "user");
    input.value = "";
    try {
      const res = await fetch(WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: msg })
      });
      const data = await res.json();
      addMessage(data.reply, "bot");
    } catch (err) {
      addMessage("âš ï¸ Error menghubungi server.", "bot");
    }
  }

  sendBtn.addEventListener("click", () => sendMessage(input.value.trim()));
  input.addEventListener("keypress", e => {
    if (e.key === "Enter") sendMessage(input.value.trim());
  });
  quickBtns.forEach(btn => btn.addEventListener("click", () => sendMessage(btn.textContent)));
</script>
<body>
<button id="chatToggle">ðŸ’¬</button>
<div id="chatWidget">
  <div id="chatHeader">Fun Face Donuts</div>
  <div id="chatbox"></div>
  <div id="quickReplies">
    <button class="quick-btn">Harga</button>
    <button class="quick-btn">Lokasi</button>
    <button class="quick-btn">Jam Buka</button>
  </div>
  <div id="inputArea">
    <input id="input" placeholder="Tulis pesan..." />
    <button id="send">Kirim</button>
  </div>
</div>
<script>
  const WEBHOOK_URL = "https://YOUR-N8N-ID.n8n.cloud/webhook/funface-chatbot";
  const toggleBtn = document.getElementById("chatToggle");
  const widget = document.getElementById("chatWidget");
  const chatbox = document.getElementById("chatbox");
  const input = document.getElementById("input");
  const sendBtn = document.getElementById("send");
  const quickBtns = document.querySelectorAll(".quick-btn");

  let greeted = localStorage.getItem("chatbot_greeted");

  function addMessage(text, sender) {
    const div = document.createElement("div");
    div.className = `msg ${sender}`;
    div.textContent = text;
    chatbox.appendChild(div);
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  function showGreeting() {
    if (!greeted) {
      addMessage("Halo ðŸ‘‹, selamat datang di Fun Face Donuts! Silakan pilih tombol cepat atau ketik pertanyaanmu.", "bot");
      localStorage.setItem("chatbot_greeted", "true");
    }
  }

  toggleBtn.addEventListener("click", () => {
    widget.style.display = widget.style.display === "flex" ? "none" : "flex";
    if (widget.style.display === "flex") showGreeting();
  });

  async function sendMessage(msg) {
    if (!msg) return;
    addMessage(msg, "user");
    input.value = "";
    try {
      const res = await fetch(WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: msg })
      });
      const data = await res.json();
      addMessage(data.reply, "bot");
    } catch (err) {
      addMessage("âš ï¸ Error menghubungi server.", "bot");
    }
  }

  sendBtn.addEventListener("click", () => sendMessage(input.value.trim()));
  input.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage(input.value.trim()); });
  quickBtns.forEach(btn => btn.addEventListener("click", () => sendMessage(btn.textContent)));
</script>
</body>
</html>
